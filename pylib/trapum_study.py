from pylib.fermi_sources import *


def table1():
    q = """J0048.6−6347 0.53 59034.2131 53 114 135 59196.6117 50 88 97
    J0139.5−2228 0.29 59123.8042 53 110 142 59196.6191 50 94 112
    J0251.1−1830 0.13 59034.206 52 112 136 59202.7276 49 78 89
    J0312.1−0921† 0.94 59034.1976 52 112 132 59202.7204 49 86 95
    J0414.7−4300 0.45 59034.1435 52 113 136 59202.6874 49 92 106
    J0529.9−0224 0.3 59065.4275 49 120 144 59188.1007 51 97 117
    J0540.0−7552‡ 0.19 59034.221 52 113 138 59188.1084 50 89 105
    J0657.4−4658 0.26 59065.4594 50 121 142 59188.1538 50 96 115
    J0712.0−6431 0.17 59065.5499 50 122 189 59188.161 49 99 118
    J0802.1−5612† 0.91 59065.444 52 128 148 59182.2759 54 94 108
    J0940.3−7610‡ 0.94 59065.4674 51 126 144 59188.1155 50 81 93
    J0953.6−1509 0.89 59065.4514 49 118 137 59182.2831 53 94 112
    J1036.6−4349∗ 0.45 59065.4908 53 130 148 59182.3887 54 94 112
    J1106.7−1742 0.57 59065.498 50 122 140 59182.3508 53 94 113
    J1120.0−2204‡ 0.75 59065.5058 52 126 143 59188.1761 49 64 74
    J1126.0−5007 0.21 59065.4357 50 119 224 59182.412 54 95 111
    J1204.5−5032 0.5 59020.8389 50 113 182 59188.0925 51 99 115
    J1207.4−4536 0.7 59065.4835 52 127 152 59250.2806 54 103 126
    J1213.9−4416 0.23 59065.5129 51 122 140 59188.1316 50 87 99
    J1231.6−5116† 0.96 59065.528 53 130 152 — — — —
    J1303.1−4714 0.15 59065.4207 67 159 248 59188.1244 51 103 121
    J1345.9−2612 0.34 59065.4747 49 116 133 59188.1389 51 94 113
    J1400.0−2415 0.91 59020.7561 50 117 134 59188.1461 51 87 100
    J1416.7−5023 0.55 59020.7634 53 125 147 59188.1686 54 95 108
    J1450.8−1424 0.14 59065.5427 52 130 158 59188.1981 51 96 111
    J1458.8−2120 0.46 59065.5578 51 122 139 59188.1909 51 83 95
    J1513.7−1519 0.19 59020.7276 51 120 143 59188.2053 52 91 103
    J1517.7−4446 0.24 59065.5205 57 143 168 59188.1837 55 109 130
    J1526.6−2743∗ 0.68 59020.7346 51 120 140 — — — —
    J1526.6−3810 0.23 59065.5353 57 140 168 59188.2124 55 110 132
    J1539.4−3323 0.9 59020.7418 52 116 140 59182.3427 57 100 116
    J1543.6−0244 0.83 59182.3063 54 94 109 59250.3519 55 104 125
    J1544.2−2554 0.59 59020.749 51 120 138 59196.4976 52 86 97
    J1612.1+1407 0.84 59020.7713 52 123 144 59196.4842 66 114 129
    J1622.2−7202 0.37 59065.5655 53 130 153 59182.2916 54 95 112
    J1623.9−6936∗ 0.17 59020.7123 51 119 137 59196.5798 51 83 94
    J1630.1−1049 0.57 59020.8087 51 122 166 59182.2992 56 98 114
    J1646.7−2154 0.17 59020.7198 53 127 175 59182.3136 58 102 270
    J1656.4−0410 0.18 59123.674 134 271 337 59182.3591 55 97 112
    J1659.0−0140 0.61 59123.7308 57 116 146 59182.3735 56 99 114
    J1709.4−0328∗ 0.13 59123.7082 57 117 147 59196.5426 53 98 112
    J1711.9−1922 0.35 59020.8238 54 127 154 59196.5498 54 90 101
    J1717.5−5804 0.66 59020.7791 54 126 147 59196.603 55 92 103
    J1720.6+0708 0.6 59020.7944 53 124 144 59196.521 54 97 112
    J1722.8−0418 0.29 59123.7452 58 118 147 59196.557 53 85 96
    J1727.4+0326 0.13 59182.3663 57 99 115 59250.3446 57 119 138
    J1730.4−0359 0.86 59123.738 58 118 150 59196.5641 54 82 95
    J1735.3−0717 0.32 59123.7816 59 119 147 59196.5956 55 99 112
    J1747.6+0324 0.46 59123.7673 59 121 152 59182.3969 59 103 122
    J1749.8−0303 0.22 59020.8015 55 128 146 59196.5884 56 95 105
    J1757.7−6032∗ 0.84 59020.8314 52 121 140 59182.321 56 100 120
    J1803.1−6708∗ 0.23 59020.8161 51 118 138 — — — —
    J1813.7−6846 0.12 59123.6858 56 115 146 59182.3281 55 98 118
    J1816.4−6405 0.47 59123.6931 57 116 148 59182.3353 56 99 120
    J1816.7+1749 0.2 59123.7009 58 118 147 59196.5063 53 94 105
    J1818.6+1316 0.77 59123.7601 57 118 147 59196.5282 53 92 104
    J1822.9−4718 0.2 59123.7159 56 117 145 59202.6346 55 94 104
    J1823.8−3544∗ 0.13 59034.0991 58 125 150 —
    J1824.2−5427 0.61 59123.6786 55 114 143 59182.3811 55 96 111
    J1827.5+1141 0.96 59123.7744 59 121 151 59196.5354 55 92 103
    J1831.1−6503 0.67 59123.7231 55 114 143 59202.6716 52 73 85
    J1845.8−2521 0.85 59123.8123 61 124 155 59202.6571 56 96 107
    J1858.3−5424∗ 0.71 59034.1361 54 118 140 — — — —
    J1906.0−1718 0.33 59034.1066 57 123 150 59182.4041 57 101 123
    J1906.4−1757∗ 0.14 59123.7962 58 120 151 — — — —
    J1913.4−1526 0.51 59123.789 58 120 150 59202.6428 54 95 105
    J1916.8−3025 0.59 59123.7525 57 117 147 59202.6643 53 72 84
    J1924.8−1035 0.78 59202.65 54 83 95 59250.31 59 102 128
    J1947.6−1121 0.18 59034.1285 55 118 142 59202.6791 52 89 100
    J2026.3+1431 0.19 59196.5136 51 90 100 59250.3282 55 110 130
    J2043.9−4802 0.87 59034.1757 53 116 143 59202.7498 51 77 88
    J2112.5−3043 0.96 59034.183 53 115 138 59202.6952 50 60 67
    J2121.8−3412 0.23 59034.2283 53 114 141 59202.757 50 94 111
    J2133.1−6432 0.77 59034.1903 53 115 137 59202.7354 50 81 91
    J2201.0−6928 0.41 59034.1214 53 113 133 59202.7426 50 86 95
    J2212.4+0708 0.92 59034.1595 53 113 133 59202.7041 50 87 99
    J2219.7−6837 0.52 59034.1138 53 114 135 59196.4899 50 78 90
    J2241.4−8327 0.33 59034.152 53 113 132 59202.7119 50 87 96
    J2355.5−6614 0.24 59034.1679 53 115 137 59196.5724 50 91 104""".split('\n')

    names = ['4FGL '+line.split()[0] for line in q if len(line)>0]
    return list(filter(lambda n: len(n)==17, names))

def introduction():
    show("""# Check the TRAPUM L-band survey list""")
    show_date()
    show(""" [reference](https://arxiv.org/abs/2212.08528)

         """)

# introduction()
def check_the99(data):
    names = table1()
    show(f"""Got {len(names)} 4FGL names from Table I""")

    df = SpecialCut()(data).query('pulsar_type=="predicted"')
    show(f"""Loaded the special selection (the "99") from the psr-predicted unassociated, {len(df)} total.""")
    a,b, c  = set(names), set(data.index), set(df.index)
    d = data.loc[list(a.intersection(b))]

    show(f"""There are {len(d)} in my predicted psr list:<br>  {list(d.index)} """)
    show(f"""The number in the "99" set:  {len(a.intersection(c))}""")
#============================================================================
#        New list
#============================================================================

class Trapum:
    """Elizabeth Ferrara's list as of 9/28/23
    and the found subset
    """
    def __init__(self):
        data = """
J0758.8-1450 A+ 119.70195770263672 -14.826539039611816 1.7372624203562737 1.578756831586361 -88.027756 0.0 
J0933.8-6232 A+ 143.4501495361328 -62.542816162109375 0.9917454421520233 0.9653449058532715 -78.67984 0.00010245283874610323 
J1857.8-3220 A+ 284.4513244628906 -32.349769592285156 4.022830277681351 3.590421974658966 -33.078148 0.0 
J0131.7-5346 A 22.92626953125 -53.80809783935547 3.4725648164749146 3.093452677130699 45.756104 0.00030735852305951994 
J0826.1-5053 A 126.54955291748047 -50.917152404785156 2.403891384601593 2.2002024203538895 -73.9173 0.00030735852305951994 
J1336.9-4611 A 204.22593688964844 -46.17833709716797 6.007558107376099 5.16814649105072 48.831932 0.0 
J1408.7-3747 A 212.2039337158203 -37.80043029785156 3.623857721686363 3.5286933928728104 80.00962 0.00010245283874610323 
J1517.9-5233 A 229.49380493164062 -52.555198669433594 2.0186036825180054 1.8638459220528603 22.276703 0.0 
J1544.2-2554 A 236.06150817871094 -25.90695571899414 2.3129624873399734 2.054230347275734 27.240734 0.0 
J1711.0-3002 A 257.78668212890625 -30.04503631591797 3.2885216921567917 2.865569293498993 -9.250807 0.0 
J1729.9-2403 A 262.5219421386719 -24.060583114624023 3.518878072500229 3.390282243490219 -11.962539 0.0 unk
J1757.1-3554 A 269.28924560546875 -35.902156829833984 4.178043901920319 3.8559307157993317 -88.997665 0.00030735852305951994 
J1820.6-0326 A 275.1806945800781 -3.4555914402008057 4.702620953321457 3.753092586994171 -30.080788 0.0 
J1849.0-1826 A 282.2708435058594 -18.437679290771484 5.29100775718689 5.075049698352814 79.08098 0.0 
J1917.6-3204 A 289.3608703613281 -32.07078552246094 4.07352402806282 3.7251153588294983 12.221958 3.024102821946144 
J0336.7-2445 A- 54.183807373046875 -24.760276794433594 6.934120953083038 5.780869871377945 30.09357 0.0 
J0749.8-4420 A- 117.46829223632812 -44.36360549926758 5.241159796714783 3.558436408638954 65.949425 0.00020490567749220645 
J1256.1-5652 A- 194.021484375 -56.843685150146484 5.985604673624039 4.948999285697937 11.8646755 0.0 unk
J1536.5-6855 A- 234.1642608642578 -68.92449951171875 5.034463405609131 4.432457238435745 2.430052 0.00010245283874610323 
J1622.2-1930 A- 245.55389404296875 -19.515417098999023 6.735286563634872 5.359535068273544 25.58963 0.008799069619271904 
J1635.4-3249 A- 248.84681701660156 -32.8329963684082 3.9169438183307648 3.533005937933922 46.342705 0.0 
J1656.5-2733 A- 254.12538146972656 -27.571046829223633 3.0238422006368637 2.9527996480464935 4.9039803 0.00010245283874610323 
J1706.2-4950 A- 256.5453186035156 -49.85172653198242 6.045617312192917 5.235839635133743 59.30422 1.0570869594812393 
J1735.2-2153 A- 263.81683349609375 -21.878599166870117 4.628941565752029 4.130779355764389 43.6107 0.0 
J1748.8-3915 A- 267.18121337890625 -39.24604415893555 2.7863138169050217 2.2904907166957855 -57.23569 0.0 
J1805.1-3618 A- 271.28851318359375 -36.30590057373047 2.0960520207881927 1.9711241126060486 14.195841 0.0 
J1808.4-3358 A- 272.10418701171875 -33.996124267578125 2.1662726998329163 2.061721980571747 29.389402 0.0 
J1825.8+1204 A- 276.4673156738281 12.056528091430664 5.491339713335037 4.596132785081863 -6.670143 0.0 
J1924.8-1035 A- 291.2130432128906 -10.574225425720215 2.031211405992508 1.8689831346273422 38.01594 5.122641937305161e-05 
J1940.2-2511 A- 295.029541015625 -25.18955421447754 4.226886481046677 3.54947067797184 19.305971 0.0 
J0423.0-0943 B+ 65.74983215332031 -9.71028995513916 2.936335578560829 2.7715107053518295 51.629036 0.0 
J0718.8-5004 B+ 109.62810516357422 -50.07785415649414 3.981866240501404 3.63249309360981 -65.361565 0.0 
J0722.4-2650 B+ 110.60395050048828 -26.83611297607422 2.6437823474407196 2.2640128433704376 -60.34817 0.0 
J0811.0-5636 B+ 122.71748352050781 -56.58704376220703 5.355802774429321 4.060719609260559 -59.37488 0.0 
J0855.0-6026 B+ 133.82830810546875 -60.508846282958984 5.921941548585892 4.206281751394272 -20.206526 0.0 
J1048.5-5923 B+ 162.13063049316406 -59.36857604980469 3.234187066555023 3.106142207980156 60.52373 0.0 
J1203.5-1748 B+ 180.8998565673828 -17.795175552368164 3.8725215196609497 3.3436869084835052 24.700178 0.0 
J1208.0-6900 B+ 181.99696350097656 -69.0151596069336 2.9776715487241745 2.514178678393364 66.87693 0.00010245283874610323 
J1208.5-5512 B+ 182.13902282714844 -55.18564224243164 4.8476046323776245 3.905152827501297 3.0539508 0.0 
J1335.5-4546 B+ 203.8315887451172 -45.782379150390625 5.313310325145721 4.160588085651398 84.08083 0.0 
J1401.3-5012 B+ 210.31666564941406 -50.146881103515625 5.162074416875839 4.288855791091919 -47.453163 0.00010245283874610323 
J1404.8-5237 B+ 211.2006378173828 -52.615753173828125 2.778867781162262 2.3473280668258667 45.405758 0.00020490567749220645 
J1603.3-6010 B+ 240.8375244140625 -60.18792724609375 1.6301024705171585 1.4590611308813095 11.8248205 0.00030735852305951994 
J1620.5-5729 B+ 245.1155242919922 -57.47003173828125 4.329697340726852 3.370271623134613 68.76385 0.0 
J1639.0-2727 B+ 249.7318115234375 -27.410356521606445 5.591982454061508 3.982613682746887 -24.676311 0.00010245283874610323 
J1659.2-1443 B+ 254.8253936767578 -14.742873191833496 4.626325964927673 3.129393383860588 -70.93235 0.00010245283874610323 
J1700.8-7304 B+ 255.17445373535156 -73.06177520751953 4.122690260410309 3.64748015999794 -7.7994866 0.0 
J1702.7-5655 B+ 255.70660400390625 -56.931297302246094 1.0733714327216148 1.059822142124176 25.049856 0.00030735852305951994 
J1703.6-2850 B+ 255.9027557373047 -28.825735092163086 2.5884059071540833 2.1034234017133713 -83.21182 0.00010245283874610323 
J1744.0-1311 B+ 266.0160827636719 -13.180130004882812 2.268698439002037 2.1442218124866486 -5.608944 5.122641937305161e-05 
J1744.7-1557 B+ 266.20526123046875 -15.939571380615234 2.720341756939888 2.5334058701992035 56.540684 0.0 
J1816.4-2727 B+ 274.1056213378906 -27.46044921875 3.175521567463875 2.624628469347954 15.7101345 0.0 
J1854.3-3640 B+ 283.5996398925781 -36.69690704345703 3.9947444200515747 3.245045319199562 6.100686 0.0 
J1956.6-7011 B+ 299.1301574707031 -70.2353744506836 4.223930686712265 3.5628772526979446 -6.418243 0.0 
J2046.1-1626 B+ 311.559814453125 -16.439619064331055 3.0468542128801346 2.7693939954042435 83.94839 0.0 
J2056.4-5922 B+ 314.1720886230469 -59.35028076171875 4.2880502343177795 3.1796105951070786 45.783455 0.0 
J0347.0-6400 B 56.738059997558594 -64.02163696289062 3.2589586079120636 3.102741166949272 26.173275 0.0 
J0454.6-1740 B 73.66310119628906 -17.670883178710938 4.660614877939224 3.7478376924991608 56.022224 0.007541841769125313 
J0524.7-8304 B 80.96978759765625 -83.0855484008789 2.845306098461151 2.7308329939842224 -20.88491 0.00023051889911585022 
J0642.9-6501 B 100.65377044677734 -65.04061889648438 4.249422401189804 3.3796915411949158 72.14243 0.0004098113549844129 
J0735.0-7255 B 113.7914810180664 -72.91280364990234 3.822691887617111 3.758091777563095 -64.05138 0.0004098113549844129 
J0739.6-4530 B 114.86833953857422 -45.49273681640625 4.103794544935226 3.5834048688411713 7.8815994 0.00010245283874610323 
J0836.6-6036 B 129.15733337402344 -60.57904052734375 4.044619202613831 3.9264920353889465 73.73824 0.0 
J1031.4-4448 B 157.8697509765625 -44.805423736572266 4.398704320192337 3.9333271980285645 68.5895 0.00030735852305951994 
J1213.9-4416 B 183.49447631835938 -44.266075134277344 2.5000304728746414 2.250547930598259 -19.737593 0.0 
J1217.2-2500 B 184.29493713378906 -24.99270248413086 4.86938863992691 4.825512617826462 -20.694088 0.0 
J1322.0-4624 B 200.52113342285156 -46.39635467529297 4.430130422115326 3.852073699235916 32.97912 0.00020490567749220645 
J1545.2-4553 B 236.282958984375 -45.874267578125 5.797344446182251 4.254775643348694 6.574662 0.0 
J1548.3-2411 B 237.0515594482422 -24.232013702392578 5.271489769220352 4.164504110813141 -15.250889 0.0 
J1710.3-3039 B 257.544189453125 -30.62448501586914 3.9803409576416016 3.0825235694646835 -52.84255 0.00020490567749220645 
J1720.6-2442 B 260.158447265625 -24.699115753173828 3.434838205575943 2.9793445765972137 72.24416 0.00020490567749220645 
J1721.3-5257 B 260.3719482421875 -52.94658660888672 4.506924748420715 4.219508171081543 -89.43492 0.0 
J1736.6-1954 B 264.164306640625 -19.94112777709961 5.474047511816025 4.92625817656517 -17.454298 2.8047198057174683 
J1741.1-1617 B 265.2785949707031 -16.29930305480957 4.351302981376648 4.086768329143524 -58.158237 0.0 
J1752.8-4449 B 268.2092590332031 -44.821556091308594 2.240857556462288 2.0763621479272842 73.9752 0.00010245283874610323 
J1754.3-4443 B 268.58380126953125 -44.72541046142578 3.4306832402944565 2.9863645881414413 -0.78984386 0.00010245283874610323 
J1800.3-5237 B 270.1220397949219 -52.61708068847656 5.618648082017899 3.868098109960556 58.676662 0.0 
J1827.3-4128 B 276.82177734375 -41.48294448852539 5.575767159461975 4.92795467376709 -63.663303 1.037181168794632 
J1830.7-2414 B 277.7051086425781 -24.259090423583984 5.25599330663681 4.804605692625046 43.811497 0.0 
J1851.0+1558 B 282.76995849609375 15.946327209472656 5.498990714550018 4.4868917763233185 11.890521 1.3231852278113365 
J1858.5-4446 B 284.6668395996094 -44.74492645263672 3.996858447790146 3.2773324102163315 4.1305137 0.00020490567749220645 
J1904.0-5925 B 286.0262145996094 -59.450111389160156 3.8691218197345734 3.7866152822971344 12.169416 0.00010245283874610323 
J1914.6-1157 B 288.6639404296875 -11.943693161010742 4.541227072477341 3.9406442642211914 -32.612213 0.0 
J1916.8-3025 B 289.20550537109375 -30.429798126220703 1.4379411935806274 1.3648873195052147 -85.10439 0.0 
J1955.8+1154 B 298.95416259765625 11.907377243041992 4.045038521289825 3.3881335705518723 27.622826 0.4065133351832628 
J2100.0-4356 B 315.0388488769531 -43.9688835144043 4.244906455278397 3.9783860743045807 -6.573217 0.00020490567749220645 
J2138.9-0408 B 324.75616455078125 -4.148951053619385 5.230587869882584 4.86278772354126 -10.738724 0.0 
J2200.0-5059 B 329.9726867675781 -50.96077346801758 5.962528735399246 5.028296113014221 -61.557125 2.2103458642959595 
J2343.0-4756 B 355.78533935546875 -47.968170166015625 4.400485306978226 3.525605946779251 8.390668 0.0 
""".split('\n')
        self.list = np.array(['4FGL '+line.split()[0]  for line in data if len(line)>0])

        t ="""J0131.7-5346
        J0739.6-4530
        J0749.8-4420
        J0836.6-6036
        J1208.0-6900
        J1544.2-2554
        J1603.3-6010
        J1639.0-2727
        J1830.7-2414
        J2056.4-5922""".split()
        self.found =  np.array(['4FGL '+x for x in t if len(x)>0], )

trapum = Trapum()